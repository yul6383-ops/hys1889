<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="order.css">
    <title>ê²Œì‹œê¸€ ìƒì„¸ë³´ê¸°</title>
</head>
<body>

<a href="wishlist.html" class="wishlist-link">
    <span class="wishlist-icon">ğŸ›’</span>
    <span class="wishlist-count">0</span>
</a>



    <div class="ë©”ë‰´">
    
        <div class="ìƒë‹¨">
             <a href="index.html">
            <img src="images/HYSLOGS.png" alt="í•˜ì˜ˆì„±í•©íŒ ë¡œê³ " class="logo">
        </a>
            <a href="index.html" style="text-decoration: none; color: inherit;">
                <div class="logotext">í•˜ ì˜ˆ ì„± í•© íŒ</div>
            </a>
        
            <a href="index.html" style="text-decoration: none; color: inherit;">
                <div class="logotext1">interior materials</div>
            </a>
        
        </div>
    
</div>

<div class="ë©”ë‰´2">
    
    <div class="line top-line"></div>
    
    <div class="boxtext">
        <a href="brand.html">ì—…ì²´ì†Œê°œ</a>
        <a href="jepom.html">ì œí’ˆì•ˆë‚´</a>
        <a href="goji.html">ê³µì§€ì‚¬í•­</a>
        <a href="root.html">ì˜¤ì‹œëŠ”ê¸¸</a>
        <a href="order.html">ë¬¸ì˜í•˜ê¸°</a>
    </div>
   
    <div class="line bottom-line"></div>    

</div>

<section class="contact-section">
    <div class="contact-line"></div>
    <h2 class="contact-title">ê±´ì ë¬¸ì˜</h2>
    <p class="contact-subtitle">ì§ˆë¬¸ì— ëŒ€í•œ ê¶ê¸ˆì¦ì„ í•´ê²°í•´ë“œë¦½ë‹ˆë‹¤.</p>
    
    <div class="write-container">
        <table class="write-table">
            <tr>
                <th>ì‘ì„±ì</th>
                <td id="viewAuthor"></td>
            </tr>
            <tr>
                <th>ì‘ì„±ì¼</th>
                <td id="viewDate"></td>
            </tr>
            <tr>
                <th>ì¡°íšŒìˆ˜</th>
                <td id="viewViews"></td>
            </tr>
            <tr>
                <th>ì œëª©</th>
                <td id="viewTitle"></td>
            </tr>
            <tr>
                <th>ë‚´ìš©</th>
                <td>
                    <div id="viewContent" style="min-height: 300px; padding: 15px; white-space: pre-wrap;"></div>
                </td>
            </tr>
        </table>
        
        <div class="button-group">
            <button type="button" class="cancel-btn" onclick="location.href='order.html'">ëª©ë¡</button>
            <button type="button" class="edit-btn" onclick="editPost()" style="background-color: #28a745;">ìˆ˜ì •</button>
            <button type="button" class="submit-btn" onclick="deleteCurrentPost()" style="background-color: #dc3545;">ì‚­ì œ</button>
        </div>
    </div>
</section>

<footer class="footer">
    <div class="footer-content">
        <div class="footer-top">
            <div class="footer-contact">
                <h3>ê³ ê°ì„¼í„° <span class="phone">010-7654-6766, 010-9307-1889</span></h3>
                <p>í‰ì¼ ì˜¤ì „ 6ì‹œ30ë¶„ ~ ì˜¤í›„ 5ì‹œ (ì¼ìš”ì¼ ë° ê³µíœ´ì¼ íœ´ë¬´)</p>
            </div>
            <div class="footer-buttons">
                <button class="kakao-btn">ìƒë‹´í•˜ê¸° ğŸ’¬</button>
                <button class="faq-btn">FAQ/ë¬¸ì˜í•˜ê¸°</button>
            </div>
        </div>

        <div class="footer-menu">
            <div class="menu-column">
                <h4>ë¸Œëœë“œ ì†Œê°œ</h4>
                <a href="#">í•˜ì˜ˆì„±í•©íŒ ì†Œê°œ</a>
                <a href="#">ëŒ€í‘œì¸ì‚¬ë§</a>
            </div>
            <div class="menu-column">
                <h4>#[ì”ì²´ ì¤‘ë¬¸ í˜œíƒ] ë­‰ì¹˜ë©´ ì‹¸ì§„ë‹¤!</h4>
                <a href="#">ì´ë²¤íŠ¸ ì•ˆë‚´ ë³´ê¸°</a>
                <a href="#">ë‹¨ì²´ ê³µë™êµ¬ë§¤ ì‹ ì²­í•˜ê¸°</a>
                <a href="#">ìƒí’ˆë³´ê¸°</a>
            </div>
            <div class="menu-column">
                <h4>#[ì˜ë¦¼ íšŒì› ì „ìš©]30ì£¼ë…„ ë¬¸ì§í• ì¸ ì´ë²¤íŠ¸!</h4>
                <a href="#">í˜œíƒ ìì„¸íˆ ë³´ê¸°</a>
                <a href="#">ìƒí’ˆë³´ê¸°</a>
            </div>
            <div class="menu-column">
                <h4>ì˜ë¦¼ ë³´ê¸‰í˜•ëŒ€ëŸ‰ì„¸ì¼</h4>
                <a href="#">ìƒí’ˆë³´ê¸°</a>
            </div>
            <div class="menu-column">
                <h4>í•©íŒ ìì¬ ë¬¸ì˜</h4>
            </div>
            <div class="menu-column">
                <h4>ì„œë¹„ìŠ¤</h4>
                <a href="#">ê³µì§€ì‚¬í•­</a>
                <a href="#">ìì£¼ë¬»ëŠ”ì§ˆë¬¸</a>
                <a href="#">ê¸°íšì „</a>
                <a href="#">ì´ë²¤íŠ¸</a>
            </div>
        </div>

        <div class="footer-info">
            <div class="info-links">
                <a href="#">ê³µì§€ì‚¬í•­</a> | 
                <a href="#">ì´ìš©ì•½ê´€</a> | 
                <a href="#">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a> | 
                <a href="#">í•˜ì˜ˆì„±í•©íŒë³´í—˜</a>
            </div>
            <p>ìƒí˜¸: í•˜ì˜ˆì„±í•©íŒ | ëŒ€í‘œ: ì´í¬ì—´ | ì£¼ì†Œ: ê²½ê¸°ë„ ê¹€í¬ì‹œ ê³ ì´Œì íƒœë¦¬ë¡œ37 2ì¸µ </p>
            <p>ëŒ€í‘œë²ˆí˜¸: 010-7654-6766 | ì´ë©”ì¼: eh1048@naver.com | íŒ©ìŠ¤: ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸: 675-15-02806 | í†µì‹ íŒë§¤ì—…ì‹ ê³ ë²ˆí˜¸: ë¯¸ì •</p>
            <p class="copyright">Copyright @ í•˜ì˜ˆì„±í•©íŒ All Rights Reserved.<br>Powered by Eoding Corp.</p>
        </div>
    </div>
</footer>
<!-- -----------------------------------------------ìŠ¤í¬ë¦½ ìˆ˜ì • -->
<script type="module">
// Firebase ëª¨ë“ˆ ê°€ì ¸ì˜¤ê¸°
import { db, collection, addDoc, getDocs, getDoc, doc, updateDoc, deleteDoc, increment } from './firebacs-config.js';

let currentPostId;

// í˜ì´ì§€ ë¡œë“œì‹œ ê²Œì‹œê¸€ í‘œì‹œ
window.addEventListener('DOMContentLoaded', async function() {
    const urlParams = new URLSearchParams(window.location.search);
    currentPostId = urlParams.get('id');
    const isAdmin = localStorage.getItem('isAdmin') === 'true';
    
    if (!currentPostId) {
        alert('ê²Œì‹œê¸€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        location.href = 'order.html';
        return;
    }
    
    try {
        const docRef = doc(db, 'posts', currentPostId);
        const docSnap = await getDoc(docRef);
        
        if (!docSnap.exists()) {
            alert('ê²Œì‹œê¸€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            location.href = 'order.html';
            return;
        }
        
        const post = docSnap.data();
        
        // ë¹„ë°€ê¸€ í™•ì¸
        if (post.isSecret && !isAdmin) {
            const inputPassword = prompt('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:');
            if (inputPassword !== post.password) {
                alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                location.href = 'order.html';
                return;
            }
        }
        
        // ì¡°íšŒìˆ˜ ì¦ê°€
        await updateDoc(docRef, {
            views: increment(1)
        });
        
        // ê²Œì‹œê¸€ ë‚´ìš© í‘œì‹œ
        document.getElementById('viewAuthor').textContent = post.author;
        document.getElementById('viewDate').textContent = post.date;
        document.getElementById('viewViews').textContent = (post.views || 0) + 1;
        document.getElementById('viewTitle').textContent = (post.isSecret ? 'ğŸ”’ ' : '') + post.title;
        document.getElementById('viewContent').textContent = post.content;
        
    } catch (error) {
        console.error('ê²Œì‹œê¸€ ë¡œë”© ì˜¤ë¥˜:', error);
        alert('ê²Œì‹œê¸€ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        location.href = 'order.html';
    }
});

// ë¹„ë°€ë²ˆí˜¸ í™•ì¸ í•¨ìˆ˜
async function checkPassword() {
    const isAdmin = localStorage.getItem('isAdmin') === 'true';
    
    // ê´€ë¦¬ìëŠ” ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì—†ì´ í†µê³¼
    if (isAdmin) {
        return true;
    }
    
    try {
        const docRef = doc(db, 'posts', currentPostId);
        const docSnap = await getDoc(docRef);
        const post = docSnap.data();
        
        const inputPassword = prompt('ê²Œì‹œê¸€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:');
        if (inputPassword === post.password) {
            return true;
        } else {
            alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            return false;
        }
    } catch (error) {
        console.error('ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì˜¤ë¥˜:', error);
        return false;
    }
}

// ì‚­ì œ í•¨ìˆ˜
window.deleteCurrentPost = async function() {
    if (!await checkPassword()) {
        return;
    }
    
    if (confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        try {
            await deleteDoc(doc(db, 'posts', currentPostId));
            alert('ê²Œì‹œê¸€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            location.href = 'order.html';
        } catch (error) {
            console.error('ì‚­ì œ ì˜¤ë¥˜:', error);
            alert('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
    }
}

// ìˆ˜ì • í•¨ìˆ˜
window.editPost = async function() {
    if (!await checkPassword()) {
        return;
    }
    
    location.href = `order-edit.html?id=${currentPostId}`;
}
</script>

<script src="wishlist-common.js"></script>

</body>
</html>